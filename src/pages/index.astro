---
// src/pages/index.astro
export const prerender = false;   // <- important for SSR

import BaseLayout from "../layouts/MainLayout.astro";
import LayoutRenderer from "../lib/wp/LayoutRenderer.astro";
import { getFlexiblePageByUri } from "../lib/api";

let page = null;
try {
  page = await getFlexiblePageByUri("/");
} catch (e) {
  page = null; // render fallback instead of throwing
}
const title = page?.title ?? "CVBS";
const layouts = page?.layouts ?? [];
---
<BaseLayout title={title}>
  {layouts.length ? <LayoutRenderer layouts={layouts} /> : <p>WP unavailable right now.</p>}
</BaseLayout>
