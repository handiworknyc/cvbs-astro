---
const vtName = "demo-title";
---
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>VT A</title>
    <style>
      h1 { font: 700 28px/1.1 system-ui; }
      a  { display:inline-block; view-transition-name: demo-title; }

      /* make transition obvious */
      ::view-transition-old(root), ::view-transition-new(root) {
        animation-duration: 350ms;
        animation-timing-function: cubic-bezier(.2,.8,.2,1);
      }
    </style>
  </head>
  <body>
    <h1><a href="/vt-b">A â†’ B</a></h1>
    <p>Support: <span id="support"></span></p>

    <script is:inline>
      // prove the script runs & whether the API exists
      document.getElementById('support').textContent =
        'startViewTransition' in document ? 'yes' : 'no';

      function onClick(e) {
        const a = e.target.closest?.('a[href]');
        if (!a) return;
        const url = new URL(a.href, location.href);
        if (url.origin !== location.origin) return;        // internal only
        if (a.target === '_blank' || e.metaKey || e.ctrlKey || e.shiftKey || e.altKey) return;

        e.preventDefault();
        const go = () => { location.href = url.href; };

        console.log('[VT-A] intercept', url.href);
        if ('startViewTransition' in document) {
          document.startViewTransition(go);
        } else {
          go();
        }
      }
      document.addEventListener('click', onClick, { capture: true });
    </script>
  </body>
</html>
